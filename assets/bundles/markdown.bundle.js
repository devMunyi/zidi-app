!function(i){var h=i.Markdown=function(e){switch(typeof e){case"undefined":this.dialect=h.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in h.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=h.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};function o(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function s(){var e=require("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}i.parse=function(e,t){return new h(t).toTree(e)},i.toHTML=function(e,t,n){var r=i.toHTMLTree(e,t,n);return i.renderJsonML(r)},i.toHTMLTree=function(e,t,n){"string"==typeof e&&(e=this.parse(e,t));var r=g(e),i={};r&&r.references&&(i=r.references);var a=function e(t,n,r){var i;r=r||{};var a=t.slice(0);"function"==typeof r.preprocessTreeNode&&(a=r.preprocessTreeNode(a,n));var o=g(a);if(o){for(i in a[1]={},o)a[1][i]=o[i];o=a[1]}if("string"==typeof a)return a;switch(a[0]){case"header":a[0]="h"+a[1].level,delete a[1].level;break;case"bulletlist":a[0]="ul";break;case"numberlist":a[0]="ol";break;case"listitem":a[0]="li";break;case"para":a[0]="p";break;case"markdown":a[0]="html",o&&delete o.references;break;case"code_block":a[0]="pre",i=o?2:1;var s=["code"];s.push.apply(s,a.splice(i,a.length-i)),a[i]=s;break;case"inlinecode":a[0]="code";break;case"img":a[1].src=a[1].href,delete a[1].href;break;case"linebreak":a[0]="br";break;case"link":a[0]="a";break;case"link_ref":a[0]="a";var l=n[o.ref];if(!l)return o.original;delete o.ref,o.href=l.href,l.title&&(o.title=l.title),delete o.original;break;case"img_ref":a[0]="img";var l=n[o.ref];if(!l)return o.original;delete o.ref,o.src=l.href,l.title&&(o.title=l.title),delete o.original}i=1;if(o){for(var c in a[1]){i=2;break}1===i&&a.splice(i,1)}for(;i<a.length;++i)a[i]=e(a[i],n,r);return a}(e,i,n);return function e(t){var n=g(t)?2:1;for(;n<t.length;)"string"==typeof t[n]?n+1<t.length&&"string"==typeof t[n+1]?t[n]+=t.splice(n+1,1)[0]:++n:(e(t[n]),++n)}(a),a};var f=h.mk_block=function(e,t,n){1==arguments.length&&(t="\n\n");var r=new String(e);return r.trailing=t,r.inspect=s,r.toSource=o,null!=n&&(r.lineNumber=n),r};function l(e){for(var t=0,n=-1;-1!==(n=e.indexOf("\n",n+1));)t++;return t}function e(o,s){var l=o+"_state",c="strong"==o?"em_state":"strong_state";function u(e){this.len_after=e,this.name="close_"+s}return function(e,t){if(this[l][0]==s)return this[l].shift(),[e.length,new u(e.length-s.length)];var n=this[c].slice(),r=this[l].slice();this[l].unshift(s);var i=this.processInline(e.substr(s.length)),a=i[i.length-1];this[l].shift();return a instanceof u?(i.pop(),[e.length-a.len_after,[o].concat(i)]):(this[c]=n,this[l]=r,[s.length,s])}}h.prototype.split_blocks=function(e,t){e=e.replace(/(\r\n|\n|\r)/g,"\n");var n,r=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,i=[],a=1;for(null!=(n=/^(\s*\n)/.exec(e))&&(a+=l(n[0]),r.lastIndex=n[0].length);null!==(n=r.exec(e));)"\n#"==n[2]&&(n[2]="\n",r.lastIndex--),i.push(f(n[1],n[2],a)),a+=l(n[0]);return i},h.prototype.processBlock=function(e,t){var n=this.dialect.block,r=n.__order__;if("__call__"in n)return n.__call__.call(this,e,t);for(var i=0;i<r.length;i++){var a=n[r[i]].call(this,e,t);if(a)return(!c(a)||0<a.length&&!c(a[0]))&&this.debug(r[i],"didn't return a proper array"),a}return[]},h.prototype.processInline=function(e){return this.dialect.inline.__call__.call(this,String(e))},h.prototype.toTree=function(e,t){var n=e instanceof Array?e:this.split_blocks(e),r=this.tree;try{for(this.tree=t||this.tree||["markdown"];n.length;){var i=this.processBlock(n.shift(),n);i.length&&this.tree.push.apply(this.tree,i)}return this.tree}finally{t&&(this.tree=r)}},h.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,e),"undefined"!=typeof console&&void 0!==console.log&&console.log.apply(null,e)},h.prototype.loop_re_over_block=function(e,t,n){for(var r,i=t.valueOf();i.length&&null!=(r=e.exec(i));)i=i.substr(r[0].length),n.call(this,r);return i},h.dialects={},h.dialects.Gruber={block:{atxHeader:function(e,t){var n=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(n){var r=["header",{level:n[1].length}];return Array.prototype.push.apply(r,this.processInline(n[2])),n[0].length<e.length&&t.unshift(f(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[r]}},setextHeader:function(e,t){var n=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(n){var r=["header",{level:"="===n[2]?1:2},n[1]];return n[0].length<e.length&&t.unshift(f(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[r]}},code:function(e,t){var n=[],r=/^(?: {0,3}\t| {4})(.*)\n?/;if(e.match(r)){e:for(;;){var i=this.loop_re_over_block(r,e.valueOf(),function(e){n.push(e[1])});if(i.length){t.unshift(f(i,e.trailing));break e}if(!t.length)break e;if(!t[0].match(r))break e;n.push(e.trailing.replace(/[^\n]/g,"").substring(2)),e=t.shift()}return[["code_block",n.join("\n")]]}},horizRule:function(e,t){var n=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(n){var r=[["hr"]];return n[1]&&r.unshift.apply(r,this.processBlock(n[1],[])),n[3]&&t.unshift(f(n[3])),r}},lists:function(){var w="[*+-]|\\d+\\.",x=/[*+-]/,$=new RegExp("^( {0,3})("+w+")[ \t]+"),S="(?: {0,3}\\t| {4})";function C(e,t,n,r){if(t)e.push(["para"].concat(n));else{var i=e[e.length-1]instanceof Array&&"para"==e[e.length-1][0]?e[e.length-1]:e;r&&1<e.length&&n.unshift(r);for(var a=0;a<n.length;a++){var o=n[a];"string"==typeof o&&1<i.length&&"string"==typeof i[i.length-1]?i[i.length-1]+=o:i.push(o)}}}function N(e,t){for(var n=new RegExp("^("+S+"{"+e+"}.*?\\n?)*$"),r=new RegExp("^"+S+"{"+e+"}","gm"),i=[];0<t.length&&n.exec(t[0]);){var a=t.shift(),o=a.replace(r,"");i.push(f(o,a.trailing,a.lineNumber))}return i}function B(e,t,n){var r=e.list,i=r[r.length-1];if(!(i[1]instanceof Array&&"para"==i[1][0]))if(t+1==n.length)i.push(["para"].concat(i.splice(1,i.length-1)));else{var a=i.pop();i.push(["para"].concat(i.splice(1,i.length-1)),a)}}return function(e,t){var n=e.match($);if(n){for(var r,i,a,o=[],s=k(n),l=!1,c=[o[0].list];;){for(var u=e.split(/(?=\n)/),h="",f=0;f<u.length;f++){var d="",p=u[f].replace(/^\n/,function(e){return d=e,""}),g=(a=o.length,new RegExp("(?:^("+S+"{0,"+a+"} {0,3})("+w+")\\s+)|(^"+S+"{0,"+(a-1)+"}[ ]{0,4})"));if(void 0!==(n=p.match(g))[1]){h.length&&(C(r,l,this.processInline(h),d),l=!1,h=""),n[1]=n[1].replace(/ {0,3}\t/g,"    ");var m=Math.floor(n[1].length/4)+1;if(m>o.length)s=k(n),r.push(s),r=s[1]=["listitem"];else{var v=!1;for(i=0;i<o.length;i++)if(o[i].indent==n[1]){s=o[i].list,o.splice(i+1,o.length-(i+1)),v=!0;break}v||(++m<=o.length?(o.splice(m,o.length-m),s=o[m-1].list):(s=k(n),r.push(s))),r=["listitem"],s.push(r)}d=""}p.length>n[0].length&&(h+=d+p.substr(n[0].length))}h.length&&(C(r,l,this.processInline(h),d),l=!1,h="");var b=N(o.length,t);0<b.length&&(T(o,B,this),r.push.apply(r,this.toTree(b,[])));var y=t[0]&&t[0].valueOf()||"";if(!y.match($)&&!y.match(/^ /))break;e=t.shift();var _=this.dialect.block.horizRule(e,t);if(_){c.push.apply(c,_);break}T(o,B,this),l=!0}return c}function k(e){var t=x.exec(e[2])?["bulletlist"]:["numberlist"];return o.push({list:t,indent:e[1]}),t}}}(),blockquote:function(e,t){if(e.match(/^>/m)){var n=[];if(">"!=e[0]){for(var r=e.split(/\n/),i=[],a=e.lineNumber;r.length&&">"!=r[0][0];)i.push(r.shift()),a++;var o=f(i.join("\n"),"\n",e.lineNumber);n.push.apply(n,this.processBlock(o,[])),e=f(r.join("\n"),e.trailing,a)}for(;t.length&&">"==t[0][0];){var s=t.shift();e=f(e+e.trailing+s,s.trailing,e.lineNumber)}var l=e.replace(/^> ?/gm,""),c=(this.tree,this.toTree(l,["blockquote"])),u=g(c);return u&&u.references&&(delete u.references,d(u)&&c.splice(1,1)),n.push(c),n}},referenceDefn:function(e,t){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(e.match(n)){g(this.tree)||this.tree.splice(1,0,{});var r=g(this.tree);void 0===r.references&&(r.references={});var i=this.loop_re_over_block(n,e,function(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1));var t=r.references[e[1].toLowerCase()]={href:e[2]};void 0!==e[4]?t.title=e[4]:void 0!==e[5]&&(t.title=e[5])});return i.length&&t.unshift(f(i,e.trailing)),[]}},para:function(e,t){return[["para"].concat(this.processInline(e))]}}},h.dialects.Gruber.inline={__oneElement__:function(e,t,n){var r,i;return t=t||this.dialect.inline.__patterns__,(r=new RegExp("([\\s\\S]*?)("+(t.source||t)+")").exec(e))?r[1]?[r[1].length,r[1]]:(r[2]in this.dialect.inline&&(i=this.dialect.inline[r[2]].call(this,e.substr(r.index),r,n||[])),i=i||[r[2].length,r[2]]):[e.length,e]},__call__:function(e,t){var n,r=[];function i(e){"string"==typeof e&&"string"==typeof r[r.length-1]?r[r.length-1]+=e:r.push(e)}for(;0<e.length;)n=this.dialect.inline.__oneElement__.call(this,e,t,r),e=e.substr(n.shift()),T(n,i);return r},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(e){return this.dialect.inline.__escape__.exec(e)?[2,e.charAt(1)]:[1,"\\"]},"![":function(e){var t=e.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0];var n={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(n.title=t[4]),[t[0].length,["img",n]]}return(t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/))?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function(e){var t=String(e),n=h.DialectHelpers.inline_until_char.call(this,e.substr(1),"]");if(!n)return[1,"["];var r,i,a=1+n[0],o=n[1],s=(e=e.substr(a)).match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(s){var l=s[1];if(a+=s[0].length,l&&"<"==l[0]&&">"==l[l.length-1]&&(l=l.substring(1,l.length-1)),!s[3])for(var c=1,u=0;u<l.length;u++)switch(l[u]){case"(":c++;break;case")":0==--c&&(a-=l.length-u,l=l.substring(0,u))}return i={href:(l=this.dialect.inline.__call__.call(this,l,/\\/)[0])||""},void 0!==s[3]&&(i.title=s[3]),r=["link",i].concat(o),[a,r]}return(s=e.match(/^\s*\[(.*?)\]/))?(a+=s[0].length,r=["link_ref",i={ref:(s[1]||String(o)).toLowerCase(),original:t.substr(0,a)}].concat(o),[a,r]):1==o.length&&"string"==typeof o[0]?(r=["link_ref",i={ref:o[0].toLowerCase(),original:t.substr(0,a)},o[0]],[a,r]):[1,"["]},"<":function(e){var t;return null!=(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"==t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(e){return[3,["linebreak"]]}},h.dialects.Gruber.inline["**"]=e("strong","**"),h.dialects.Gruber.inline.__=e("strong","__"),h.dialects.Gruber.inline["*"]=e("em","*"),h.dialects.Gruber.inline._=e("em","_"),h.buildBlockOrder=function(e){var t=[];for(var n in e)"__order__"!=n&&"__call__"!=n&&t.push(n);e.__order__=t},h.buildInlinePatterns=function(e){var n=[];for(var t in e)if(!t.match(/^__.*__$/)){var r=t.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");n.push(1==t.length?r:"(?:"+r+")")}n=n.join("|"),e.__patterns__=n;var i=e.__call__;e.__call__=function(e,t){return null!=t?i.call(this,e,t):i.call(this,e,n)}},h.DialectHelpers={},h.DialectHelpers.inline_until_char=function(e,t){for(var n=0,r=[];;){if(e.charAt(n)==t)return[++n,r];if(n>=e.length)return null;var i=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=i[0],r.push.apply(r,i.slice(1))}},h.subclassDialect=function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}},h.buildBlockOrder(h.dialects.Gruber.block),h.buildInlinePatterns(h.dialects.Gruber.inline),h.dialects.Maruku=h.subclassDialect(h.dialects.Gruber),h.dialects.Maruku.processMetaHash=function(e){for(var t=function(e){var t=e.split(""),n=[""],r=!1;for(;t.length;){var i=t.shift();switch(i){case" ":r?n[n.length-1]+=i:n.push("");break;case"'":case'"':r=!r;break;case"\\":i=t.shift();default:n[n.length-1]+=i}}return n}(e),n={},r=0;r<t.length;++r)if(/^#/.test(t[r]))n.id=t[r].substring(1);else if(/^\./.test(t[r]))n.class?n.class=n.class+t[r].replace(/./," "):n.class=t[r].substring(1);else if(/\=/.test(t[r])){var i=t[r].split(/\=/);n[i[0]]=i[1]}return n},h.dialects.Maruku.block.document_meta=function(e,t){if(!(1<e.lineNumber)&&e.match(/^(?:\w+:.*\n)*\w+:.*$/)){g(this.tree)||this.tree.splice(1,0,{});var n=e.split(/\n/);for(p in n){var r=n[p].match(/(\w+):\s*(.*)$/),i=r[1].toLowerCase(),a=r[2];this.tree[1][i]=a}return[]}},h.dialects.Maruku.block.block_meta=function(e,t){var n=e.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(n){var r,i=this.dialect.processMetaHash(n[2]);if(""===n[1]){var o=this.tree[this.tree.length-1];if(r=g(o),"string"==typeof o)return;for(a in r||(r={},o.splice(1,0,r)),i)r[a]=i[a];return[]}var s=e.replace(/\n.*$/,""),l=this.processBlock(s,[]);for(a in(r=g(l[0]))||(r={},l[0].splice(1,0,r)),i)r[a]=i[a];return l}},h.dialects.Maruku.block.definition_list=function(e,t){var n,r=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,i=["dl"];if(s=e.match(r)){for(var a=[e];t.length&&r.exec(t[0]);)a.push(t.shift());for(var o=0;o<a.length;++o){var s,l=(s=a[o].match(r))[1].replace(/\n$/,"").split(/\n/),c=s[2].split(/\n:\s+/);for(n=0;n<l.length;++n)i.push(["dt",l[n]]);for(n=0;n<c.length;++n)i.push(["dd"].concat(this.processInline(c[n].replace(/(\n)\s+/,"$1"))))}return[i]}},h.dialects.Maruku.block.table=function(e,t){var n,r,i=function(e,t){(t=t||"\\s").match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);for(var n,r=[],i=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)");n=e.match(i);)r.push(n[1]),e=n[2];return r.push(e),r};if(r=e.match(/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/))r[3]=r[3].replace(/^\s*\|/gm,"");else if(!(r=e.match(/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/)))return;var a=["table",["thead",["tr"]],["tbody"]];r[2]=r[2].replace(/\|\s*$/,"").split("|");var o=[];for(T(r[2],function(e){e.match(/^\s*-+:\s*$/)?o.push({align:"right"}):e.match(/^\s*:-+\s*$/)?o.push({align:"left"}):e.match(/^\s*:-+:\s*$/)?o.push({align:"center"}):o.push({})}),r[1]=i(r[1].replace(/\|\s*$/,""),"|"),n=0;n<r[1].length;n++)a[1][1].push(["th",o[n]||{}].concat(this.processInline(r[1][n].trim())));return T(r[3].replace(/\|\s*$/gm,"").split("\n"),function(e){var t=["tr"];for(e=i(e,"|"),n=0;n<e.length;n++)t.push(["td",o[n]||{}].concat(this.processInline(e[n].trim())));a[2].push(t)},this),[a]},h.dialects.Maruku.inline["{:"]=function(e,t,n){if(!n.length)return[2,"{:"];var r=n[n.length-1];if("string"==typeof r)return[2,"{:"];var i=e.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!i)return[2,"{:"];var a=this.dialect.processMetaHash(i[1]),o=g(r);for(var s in o||(o={},r.splice(1,0,o)),a)o[s]=a[s];return[i[0].length,""]},h.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,h.buildBlockOrder(h.dialects.Maruku.block),h.buildInlinePatterns(h.dialects.Maruku.inline);var T,c=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};T=Array.prototype.forEach?function(e,t,n){return e.forEach(t,n)}:function(e,t,n){for(var r=0;r<e.length;r++)t.call(n||e,e[r],r,e)};var d=function(e){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0};function g(e){return c(e)&&1<e.length&&"object"==typeof e[1]&&!c(e[1])?e[1]:void 0}function u(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function m(e){if("string"==typeof e)return u(e);var t=e.shift(),n={},r=[];for(!e.length||"object"!=typeof e[0]||e[0]instanceof Array||(n=e.shift());e.length;)r.push(m(e.shift()));var i="";for(var a in n)i+=" "+a+'="'+u(n[a])+'"';return"img"==t||"br"==t||"hr"==t?"<"+t+i+"/>":"<"+t+i+">"+r.join("")+"</"+t+">"}i.renderJsonML=function(e,t){(t=t||{}).root=t.root||!1;var n=[];if(t.root)n.push(m(e));else for(e.shift(),!e.length||"object"!=typeof e[0]||e[0]instanceof Array||e.shift();e.length;)n.push(m(e.shift()));return n.join("\n\n")}}("undefined"==typeof exports?(window.markdown={},window.markdown):exports),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).toMarkdown=e()}}(function(){return function a(o,s,l){function c(n,e){if(!s[n]){if(!o[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[n]={exports:{}};o[n][0].call(i.exports,function(e){var t=o[n][1][e];return c(t||e)},i,i.exports,a,o,s,l)}return s[n].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,n){"use strict";var o,s,l=e("./lib/md-converters"),c=e("./lib/gfm-converters"),u=e("./lib/html-parser"),h=e("collapse-whitespace"),r=["address","article","aside","audio","blockquote","body","canvas","center","dd","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frameset","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","isindex","li","main","menu","nav","noframes","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"];function f(e){return-1!==r.indexOf(e.nodeName.toLowerCase())}var i=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function d(e){return-1!==i.indexOf(e.nodeName.toLowerCase())}function p(e){for(var t="",n=0;n<e.childNodes.length;n++)if(1===e.childNodes[n].nodeType)t+=e.childNodes[n]._replacement;else{if(3!==e.childNodes[n].nodeType)continue;t+=e.childNodes[n].data}return t}function g(e,t){if("string"==typeof t)return t===e.nodeName.toLowerCase();if(Array.isArray(t))return-1!==t.indexOf(e.nodeName.toLowerCase());if("function"==typeof t)return t.call(o,e);throw new TypeError("`filter` needs to be a string, array, or function")}function m(e,t){var n,r,i;return r="left"===e?(n=t.previousSibling,/ $/):(n=t.nextSibling,/^ /),n&&(3===n.nodeType?i=r.test(n.nodeValue):1!==n.nodeType||f(n)||(i=r.test(n.textContent))),i}function v(e,t){var n="",r="";if(!f(e)){var i=/^[ \r\n\t]/.test(t),a=/[ \r\n\t]$/.test(t);i&&!m("left",e)&&(n=" "),a&&!m("right",e)&&(r=" ")}return{leading:n,trailing:r}}function b(e){var t,n=p(e);if(d(e)||/A|TH|TD/.test(e.nodeName)||!/^\s*$/i.test(n)){for(var r=0;r<s.length;r++){var i=s[r];if(g(e,i.filter)){if("function"!=typeof i.replacement)throw new TypeError("`replacement` needs to be a function that returns a string");var a=v(e,n);(a.leading||a.trailing)&&(n=n.trim()),t=a.leading+i.replacement.call(o,n,e)+a.trailing;break}}e._replacement=t}else e._replacement=""}(o=function(e,t){if(t=t||{},"string"!=typeof e)throw new TypeError(e+" is not a string");if(""===e)return"";e=e.replace(/(\d+)\. /g,"$1\\. ");var n,r,i=(n=e,r=(new u).parseFromString(n,"text/html"),h(r.documentElement,f),r).body,a=function(e){for(var t,n,r,i=[e],a=[];0<i.length;)for(t=i.shift(),a.push(t),n=t.childNodes,r=0;r<n.length;r++)1===n[r].nodeType&&i.push(n[r]);return a.shift(),a}(i);s=l.slice(0),t.gfm&&(s=c.concat(s)),t.converters&&(s=t.converters.concat(s));for(var o=a.length-1;0<=o;o--)b(a[o]);return p(i).replace(/^[\t\r\n]+|[\t\r\n\s]+$/g,"").replace(/\n\s+\n/g,"\n\n").replace(/\n{3,}/g,"\n\n")}).isBlock=f,o.isVoid=d,o.outer=function(e,t){return e.cloneNode(!1).outerHTML.replace("><",">"+t+"<")},t.exports=o},{"./lib/gfm-converters":2,"./lib/html-parser":3,"./lib/md-converters":4,"collapse-whitespace":7}],2:[function(e,t,n){"use strict";function s(e,t){var n=" ";return 0===Array.prototype.indexOf.call(t.parentNode.childNodes,t)&&(n="| "),n+e+" |"}var r=/highlight highlight-(\S+)/;t.exports=[{filter:"br",replacement:function(){return"\n"}},{filter:["del","s","strike"],replacement:function(e){return"~~"+e+"~~"}},{filter:function(e){return"checkbox"===e.type&&"LI"===e.parentNode.nodeName},replacement:function(e,t){return(t.checked?"[x]":"[ ]")+" "}},{filter:["th","td"],replacement:function(e,t){return s(e,t)}},{filter:"tr",replacement:function(e,t){var n="",r={left:":--",right:"--:",center:":-:"};if("THEAD"===t.parentNode.nodeName)for(var i=0;i<t.childNodes.length;i++){var a=t.childNodes[i].attributes.align,o="---";a&&(o=r[a.value]||o),n+=s(o,t.childNodes[i])}return"\n"+e+(n?"\n"+n:"")}},{filter:"table",replacement:function(e){return"\n\n"+e+"\n\n"}},{filter:["thead","tbody","tfoot"],replacement:function(e){return e}},{filter:function(e){return"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t){return"\n\n```\n"+t.firstChild.textContent+"\n```\n\n"}},{filter:function(e){return"PRE"===e.nodeName&&"DIV"===e.parentNode.nodeName&&r.test(e.parentNode.className)},replacement:function(e,t){return"\n\n```"+t.parentNode.className.match(r)[1]+"\n"+t.textContent+"\n```\n\n"}},{filter:function(e){return"DIV"===e.nodeName&&r.test(e.className)},replacement:function(e){return"\n\n"+e+"\n\n"}}]},{}],3:[function(n,e,t){var r="undefined"!=typeof window?window:this;e.exports=function(){var e=r.DOMParser,t=!1;try{(new e).parseFromString("","text/html")&&(t=!0)}catch(e){}return t}()?r.DOMParser:function(){var e=function(){};if("undefined"==typeof document){var t=n("jsdom");e.prototype.parseFromString=function(e){return t.jsdom(e,{features:{FetchExternalResources:[],ProcessExternalResources:!1}})}}else e.prototype.parseFromString=function(){var t=!1;try{document.implementation.createHTMLDocument("").open()}catch(e){window.ActiveXObject&&(t=!0)}return t}()?function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t};return e}()},{jsdom:6}],4:[function(e,t,n){"use strict";t.exports=[{filter:"p",replacement:function(e){return"\n\n"+e+"\n\n"}},{filter:"br",replacement:function(){return"  \n"}},{filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t){for(var n=t.nodeName.charAt(1),r="",i=0;i<n;i++)r+="#";return"\n\n"+r+" "+e+"\n\n"}},{filter:"hr",replacement:function(){return"\n\n* * *\n\n"}},{filter:["em","i"],replacement:function(e){return"_"+e+"_"}},{filter:["strong","b"],replacement:function(e){return"**"+e+"**"}},{filter:function(e){var t=e.previousSibling||e.nextSibling,n="PRE"===e.parentNode.nodeName&&!t;return"CODE"===e.nodeName&&!n},replacement:function(e){return"`"+e+"`"}},{filter:function(e){return"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t){var n=t.title?' "'+t.title+'"':"";return"["+e+"]("+t.getAttribute("href")+n+")"}},{filter:"img",replacement:function(e,t){var n=t.alt||"",r=t.getAttribute("src")||"",i=t.title||"";return r?"!["+n+"]("+r+(i?' "'+i+'"':"")+")":""}},{filter:function(e){return"PRE"===e.nodeName&&"CODE"===e.firstChild.nodeName},replacement:function(e,t){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},{filter:"blockquote",replacement:function(e){return"\n\n"+(e=(e=(e=e.trim()).replace(/\n{3,}/g,"\n\n")).replace(/^/gm,"> "))+"\n\n"}},{filter:"li",replacement:function(e,t){e=e.replace(/^\s+/,"").replace(/\n/gm,"\n    ");var n=t.parentNode,r=Array.prototype.indexOf.call(n.children,t)+1;return(/ol/i.test(n.nodeName)?r+".  ":"*   ")+e}},{filter:["ul","ol"],replacement:function(e,t){for(var n=[],r=0;r<t.childNodes.length;r++)n.push(t.childNodes[r]._replacement);return/li/i.test(t.parentNode.nodeName)?"\n"+n.join("\n"):"\n\n"+n.join("\n")+"\n\n"}},{filter:function(e){return this.isBlock(e)},replacement:function(e,t){return"\n\n"+this.outer(t,e)+"\n\n"}},{filter:function(){return!0},replacement:function(e,t){return this.outer(t,e)}}]},{}],5:[function(e,t,n){t.exports=["address","article","aside","audio","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","main","nav","noscript","ol","output","p","pre","section","table","tfoot","ul","video"]},{}],6:[function(e,t,n){},{}],7:[function(e,t,n){"use strict";var c=e("void-elements");Object.keys(c).forEach(function(e){c[e.toUpperCase()]=1});var r={};function u(e){return!(!e||!r[e.nodeName])}function h(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function f(e,t){return e&&e.parentNode===t||"PRE"===t.nodeName?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}e("block-elements").forEach(function(e){r[e.toUpperCase()]=1}),t.exports=function(e,t){if(e.firstChild&&"PRE"!==e.nodeName){"function"!=typeof t&&(t=u);for(var n,r=null,i=!1,a=null,o=f(a,e);o!==e;){if(3===o.nodeType){var s=o.data.replace(/[ \r\n\t]+/g," ");if(r&&!/ $/.test(r.data)||i||" "!==s[0]||(s=s.substr(1)),!s){o=h(o);continue}o.data=s,r=o}else{if(1!==o.nodeType){o=h(o);continue}t(o)||"BR"===o.nodeName?(r&&(r.data=r.data.replace(/ $/,"")),r=null,i=!1):(n=o)&&c[n.nodeName]&&(i=!(r=null))}var l=f(a,o);a=o,o=l}r&&(r.data=r.data.replace(/ $/,""),r.data||h(r))}}},{"block-elements":5,"void-elements":8}],8:[function(e,t,n){t.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},{}]},{},[1])(1)}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(k){"use strict";var i=function(n,r){k.each(["autofocus","savable","hideable","width","height","resize","iconlibrary","language","footer","fullscreen","hiddenButtons","disabledButtons"],function(e,t){void 0!==k(n).data(t)&&((r="object"==typeof r?r:{})[t]=k(n).data(t))}),this.$ns="bootstrap-markdown",this.$element=k(n),this.$editable={el:null,type:null,attrKeys:[],attrValues:[],content:null},this.$options=k.extend(!0,{},k.fn.markdown.defaults,r,this.$element.data("options")),this.$oldContent=null,this.$isPreview=!1,this.$isFullscreen=!1,this.$editor=null,this.$textarea=null,this.$handler=[],this.$callback=[],this.$nextTab=[],this.showEditor()};i.prototype={constructor:i,__alterButtons:function(n,r){var e=this.$handler,i="all"==n,a=this;k.each(e,function(e,t){!1===(!i&&t.indexOf(n)<0)&&r(a.$editor.find('button[data-handler="'+t+'"]'))})},__buildButtons:function(e,t){var n,r=this.$ns,i=this.$handler,a=this.$callback;for(n=0;n<e.length;n++){var o,s=e[n];for(o=0;o<s.length;o++){var l,c=s[o].data,u=k("<div/>",{class:"btn-group"});for(l=0;l<c.length;l++){var h,f,d=c[l],p=r+"-"+d.name,g=this.__getIcon(d.icon),m=d.btnText?d.btnText:"",v=d.btnClass?d.btnClass:"btn",b=d.tabIndex?d.tabIndex:"-1",y=void 0!==d.hotkey?d.hotkey:"",_=void 0!==jQuery.hotkeys&&""!==y?" ("+y+")":"";(h=k("<button></button>")).text(" "+this.__localize(m)).addClass("btn-default").addClass(v),v.match(/btn\-(primary|success|info|warning|danger|link)/)&&h.removeClass("btn-default"),h.attr({type:"button",title:this.__localize(d.title)+_,tabindex:b,"data-provider":r,"data-handler":p,"data-hotkey":y}),!0===d.toggle&&h.attr("data-toggle","button"),(f=k("<span/>")).addClass(g),f.prependTo(h),u.append(h),i.push(p),a.push(d.callback)}t.append(u)}}return t},__setListener:function(){var e=void 0!==this.$textarea.attr("rows"),t=5<this.$textarea.val().split("\n").length?this.$textarea.val().split("\n").length:"5",n=e?this.$textarea.attr("rows"):t;this.$textarea.attr("rows",n),this.$options.resize&&this.$textarea.css("resize",this.$options.resize),this.$textarea.on({focus:k.proxy(this.focus,this),keyup:k.proxy(this.keyup,this),change:k.proxy(this.change,this),select:k.proxy(this.select,this)}),this.eventSupported("keydown")&&this.$textarea.on("keydown",k.proxy(this.keydown,this)),this.eventSupported("keypress")&&this.$textarea.on("keypress",k.proxy(this.keypress,this)),this.$textarea.data("markdown",this)},__handle:function(e){var t=k(e.currentTarget),n=this.$handler,r=this.$callback,i=t.attr("data-handler"),a=r[n.indexOf(i)];k(e.currentTarget).focus(),a(this),this.change(this),i.indexOf("cmdSave")<0&&this.$textarea.focus(),e.preventDefault()},__localize:function(e){var t=k.fn.markdown.messages,n=this.$options.language;return void 0!==t&&void 0!==t[n]&&void 0!==t[n][e]?t[n][e]:e},__getIcon:function(e){return"object"==typeof e?e[this.$options.iconlibrary]:e},setFullscreen:function(e){var t=this.$editor,n=this.$textarea;!0===e?(t.addClass("md-fullscreen-mode"),k("body").addClass("md-nooverflow"),this.$options.onFullscreen(this)):(t.removeClass("md-fullscreen-mode"),k("body").removeClass("md-nooverflow"),1==this.$isPreview&&this.hidePreview().showPreview()),this.$isFullscreen=e,n.focus()},showEditor:function(){var n,t=this,e=this.$ns,r=this.$element,i=(r.css("height"),r.css("width"),this.$editable),a=this.$handler,o=this.$callback,s=this.$options,l=k("<div/>",{class:"md-editor",click:function(){t.focus()}});if(null===this.$editor){var c=k("<div/>",{class:"md-header btn-toolbar"}),u=[];if(0<s.buttons.length&&(u=u.concat(s.buttons[0])),0<s.additionalButtons.length&&k.each(s.additionalButtons[0],function(e,n){var t=k.grep(u,function(e,t){return e.name===n.name});0<t.length?t[0].data=t[0].data.concat(n.data):u.push(s.additionalButtons[0][e])}),0<s.reorderButtonGroups.length&&(u=u.filter(function(e){return-1<s.reorderButtonGroups.indexOf(e.name)}).sort(function(e,t){return s.reorderButtonGroups.indexOf(e.name)<s.reorderButtonGroups.indexOf(t.name)?-1:s.reorderButtonGroups.indexOf(e.name)>s.reorderButtonGroups.indexOf(t.name)?1:0})),0<u.length&&(c=this.__buildButtons([u],c)),s.fullscreen.enable&&c.append('<div class="md-controls"><a class="md-control md-control-fullscreen" href="javascript:void(0);"><span class="'+this.__getIcon(s.fullscreen.icons.fullscreenOn)+'"></span></a></div>').on("click",".md-control-fullscreen",function(e){e.preventDefault(),t.setFullscreen(!0)}),l.append(c),r.is("textarea"))r.before(l),(n=r).addClass("md-input"),l.append(n);else{var h="function"==typeof toMarkdown?toMarkdown(r.html()):r.html(),f=k.trim(h);n=k("<textarea/>",{class:"md-input",val:f}),l.append(n),i.el=r,i.type=r.prop("tagName").toLowerCase(),i.content=r.html(),k(r[0].attributes).each(function(){i.attrKeys.push(this.nodeName),i.attrValues.push(this.nodeValue)}),r.replaceWith(l)}var d,p=k("<div/>",{class:"md-footer"}),g=!1;if(s.savable){g=!0;var m="cmdSave";a.push(m),o.push(s.onSave),p.append('<button class="btn btn-success" data-provider="'+e+'" data-handler="'+m+'"><i class="icon icon-white icon-ok"></i> '+this.__localize("Save")+"</button>")}if(d="function"==typeof s.footer?s.footer(this):s.footer,""!==k.trim(d)&&(g=!0,p.append(d)),g&&l.append(p),s.width&&"inherit"!==s.width&&(jQuery.isNumeric(s.width)?(l.css("display","table"),n.css("width",s.width+"px")):l.addClass(s.width)),s.height&&"inherit"!==s.height)if(jQuery.isNumeric(s.height)){var v=s.height;c&&(v=Math.max(0,v-c.outerHeight())),p&&(v=Math.max(0,v-p.outerHeight())),n.css("height",v+"px")}else l.addClass(s.height);this.$editor=l,this.$textarea=n,this.$editable=i,this.$oldContent=this.getContent(),this.__setListener(),this.$editor.attr("id",(new Date).getTime()),this.$editor.on("click",'[data-provider="bootstrap-markdown"]',k.proxy(this.__handle,this)),(this.$element.is(":disabled")||this.$element.is("[readonly]"))&&(this.$editor.addClass("md-editor-disabled"),this.disableButtons("all")),this.eventSupported("keydown")&&"object"==typeof jQuery.hotkeys&&c.find('[data-provider="bootstrap-markdown"]').each(function(){var e=k(this),t=e.attr("data-hotkey");""!==t.toLowerCase()&&n.bind("keydown",t,function(){return e.trigger("click"),!1})}),"preview"===s.initialstate?this.showPreview():"fullscreen"===s.initialstate&&s.fullscreen.enable&&this.setFullscreen(!0)}else this.$editor.show();return s.autofocus&&(this.$textarea.focus(),this.$editor.addClass("active")),s.fullscreen.enable&&!1!==s.fullscreen&&(this.$editor.append('<div class="md-fullscreen-controls"><a href="javascript:void(0);" class="exit-fullscreen" title="Exit fullscreen"><span class="'+this.__getIcon(s.fullscreen.icons.fullscreenOff)+'"></span></a></div>'),this.$editor.on("click",".exit-fullscreen",function(e){e.preventDefault(),t.setFullscreen(!1)})),this.hideButtons(s.hiddenButtons),this.disableButtons(s.disabledButtons),s.onShow(this),this},parseContent:function(e){e=e||this.$textarea.val();return this.$options.parser?this.$options.parser(e):"object"==typeof markdown?markdown.toHTML(e):"function"==typeof marked?marked(e):e},showPreview:function(){var e,t,n=this.$options,r=this.$textarea,i=r.next(),a=k("<div/>",{class:"md-preview","data-provider":"markdown-preview"});return 1==this.$isPreview||(this.$isPreview=!0,this.disableButtons("all").enableButtons("cmdPreview"),e="string"==typeof(t=n.onPreview(this))?t:this.parseContent(),a.html(e),i&&"md-footer"==i.attr("class")?a.insertBefore(i):r.parent().append(a),a.css({width:r.outerWidth()+"px",height:r.outerHeight()+"px"}),this.$options.resize&&a.css("resize",this.$options.resize),r.hide(),a.data("markdown",this),(this.$element.is(":disabled")||this.$element.is("[readonly]"))&&(this.$editor.addClass("md-editor-disabled"),this.disableButtons("all"))),this},hidePreview:function(){return this.$isPreview=!1,this.$editor.find('div[data-provider="markdown-preview"]').remove(),this.enableButtons("all"),this.disableButtons(this.$options.disabledButtons),this.$textarea.show(),this.__setListener(),this},isDirty:function(){return this.$oldContent!=this.getContent()},getContent:function(){return this.$textarea.val()},setContent:function(e){return this.$textarea.val(e),this},findSelection:function(e){var t;if(0<=(t=this.getContent().indexOf(e))&&0<e.length){var n,r=this.getSelection();return this.setSelection(t,t+e.length),n=this.getSelection(),this.setSelection(r.start,r.end),n}return null},getSelection:function(){var t=this.$textarea[0];return("selectionStart"in t&&function(){var e=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:e,text:t.value.substr(t.selectionStart,e)}}||function(){return null})()},setSelection:function(e,t){var n=this.$textarea[0];return("selectionStart"in n&&function(){n.selectionStart=e,n.selectionEnd=t}||function(){return null})()},replaceSelection:function(e){var t=this.$textarea[0];return("selectionStart"in t&&function(){return t.value=t.value.substr(0,t.selectionStart)+e+t.value.substr(t.selectionEnd,t.value.length),t.selectionStart=t.value.length,this}||function(){return t.value+=e,jQuery(t)})()},getNextTab:function(){if(0===this.$nextTab.length)return null;var e,t=this.$nextTab.shift();return"function"==typeof t?e=t():"object"==typeof t&&0<t.length&&(e=t),e},setNextTab:function(e,t){if("string"==typeof e){var n=this;this.$nextTab.push(function(){return n.findSelection(e)})}else if("number"==typeof e&&"number"==typeof t){var r=this.getSelection();this.setSelection(e,t),this.$nextTab.push(this.getSelection()),this.setSelection(r.start,r.end)}},__parseButtonNameParam:function(e){return"string"==typeof e?e.split(" "):e},enableButtons:function(e){var n=this.__parseButtonNameParam(e),r=this;return k.each(n,function(e,t){r.__alterButtons(n[e],function(e){e.removeAttr("disabled")})}),this},disableButtons:function(e){var n=this.__parseButtonNameParam(e),r=this;return k.each(n,function(e,t){r.__alterButtons(n[e],function(e){e.attr("disabled","disabled")})}),this},hideButtons:function(e){var n=this.__parseButtonNameParam(e),r=this;return k.each(n,function(e,t){r.__alterButtons(n[e],function(e){e.addClass("hidden")})}),this},showButtons:function(e){var n=this.__parseButtonNameParam(e),r=this;return k.each(n,function(e,t){r.__alterButtons(n[e],function(e){e.removeClass("hidden")})}),this},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},keyup:function(e){var t=!1;switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:var n;if(null!==(n=this.getNextTab())){var r=this;setTimeout(function(){r.setSelection(n.start,n.end)},500),t=!0}else{var i=this.getSelection();t=(i.start!=i.end||i.end!=this.getContent().length)&&(this.setSelection(this.getContent().length,this.getContent().length),!0)}break;case 13:t=!1;break;case 27:this.$isFullscreen&&this.setFullscreen(!1),t=!1;break;default:t=!1}t&&(e.stopPropagation(),e.preventDefault()),this.$options.onChange(this)},change:function(e){return this.$options.onChange(this),this},select:function(e){return this.$options.onSelect(this),this},focus:function(e){var t=this.$options,n=(t.hideable,this.$editor);return n.addClass("active"),k(document).find(".md-editor").each(function(){var e;k(this).attr("id")!==n.attr("id")&&(null===(e=k(this).find("textarea").data("markdown"))&&(e=k(this).find('div[data-provider="markdown-preview"]').data("markdown")),e&&e.blur())}),t.onFocus(this),this},blur:function(e){var t=this.$options,n=t.hideable,r=this.$editor,i=this.$editable;if(r.hasClass("active")||0===this.$element.parent().length){if(r.removeClass("active"),n)if(null!==i.el){var a=k("<"+i.type+"/>"),o=this.getContent(),s=this.parseContent(o);k(i.attrKeys).each(function(e,t){a.attr(i.attrKeys[e],i.attrValues[e])}),a.html(s),r.replaceWith(a)}else r.hide();t.onBlur(this)}return this}};var e=k.fn.markdown;k.fn.markdown=function(r){return this.each(function(){var e=k(this),t=e.data("markdown"),n="object"==typeof r&&r;t||e.data("markdown",t=new i(this,n))})},k.fn.markdown.messages={},k.fn.markdown.defaults={autofocus:!1,hideable:!1,savable:!1,width:"inherit",height:"inherit",resize:"none",iconlibrary:"glyph",language:"en",initialstate:"editor",parser:null,buttons:[[{name:"groupFont",data:[{name:"cmdBold",hotkey:"Ctrl+B",title:"Bold",icon:{glyph:"glyphicon glyphicon-bold",fa:"fa fa-bold","fa-3":"icon-bold"},callback:function(e){var t,n,r=e.getSelection(),i=e.getContent();t=0===r.length?e.__localize("strong text"):r.text,n="**"===i.substr(r.start-2,2)&&"**"===i.substr(r.end,2)?(e.setSelection(r.start-2,r.end+2),e.replaceSelection(t),r.start-2):(e.replaceSelection("**"+t+"**"),r.start+2),e.setSelection(n,n+t.length)}},{name:"cmdItalic",title:"Italic",hotkey:"Ctrl+I",icon:{glyph:"glyphicon glyphicon-italic",fa:"fa fa-italic","fa-3":"icon-italic"},callback:function(e){var t,n,r=e.getSelection(),i=e.getContent();t=0===r.length?e.__localize("emphasized text"):r.text,n="_"===i.substr(r.start-1,1)&&"_"===i.substr(r.end,1)?(e.setSelection(r.start-1,r.end+1),e.replaceSelection(t),r.start-1):(e.replaceSelection("_"+t+"_"),r.start+1),e.setSelection(n,n+t.length)}},{name:"cmdHeading",title:"Heading",hotkey:"Ctrl+H",icon:{glyph:"glyphicon glyphicon-header",fa:"fa fa-header","fa-3":"icon-font"},callback:function(e){var t,n,r,i,a=e.getSelection(),o=e.getContent();t=0===a.length?e.__localize("heading text"):a.text+"\n",r=4,n="### "===o.substr(a.start-r,r)||(r=3,"###"===o.substr(a.start-r,r))?(e.setSelection(a.start-r,a.end),e.replaceSelection(t),a.start-r):0<a.start&&((i=o.substr(a.start-1,1))&&"\n"!=i)?(e.replaceSelection("\n\n### "+t),a.start+6):(e.replaceSelection("### "+t),a.start+4),e.setSelection(n,n+t.length)}}]},{name:"groupLink",data:[{name:"cmdUrl",title:"URL/Link",hotkey:"Ctrl+L",icon:{glyph:"glyphicon glyphicon-link",fa:"fa fa-link","fa-3":"icon-link"},callback:function(e){var t,n,r,i=e.getSelection();e.getContent();t=0===i.length?e.__localize("enter link description here"):i.text,r=prompt(e.__localize("Insert Hyperlink"),"http://");var a=new RegExp("^((http|https)://|(mailto:)|(//))[a-z0-9]","i");if(null!==r&&""!==r&&"http://"!==r&&a.test(r)){var o=k("<div>"+r+"</div>").text();e.replaceSelection("["+t+"]("+o+")"),n=i.start+1,e.setSelection(n,n+t.length)}}},{name:"cmdImage",title:"Image",hotkey:"Ctrl+G",icon:{glyph:"glyphicon glyphicon-picture",fa:"fa fa-picture-o","fa-3":"icon-picture"},callback:function(e){var t,n,r,i=e.getSelection();e.getContent();t=0===i.length?e.__localize("enter image description here"):i.text,r=prompt(e.__localize("Insert Image Hyperlink"),"http://");var a=new RegExp("^((http|https)://|(//))[a-z0-9]","i");if(null!==r&&""!==r&&"http://"!==r&&a.test(r)){var o=k("<div>"+r+"</div>").text();e.replaceSelection("!["+t+"]("+o+' "'+e.__localize("enter image title here")+'")'),n=i.start+2,e.setNextTab(e.__localize("enter image title here")),e.setSelection(n,n+t.length)}}}]},{name:"groupMisc",data:[{name:"cmdList",hotkey:"Ctrl+U",title:"Unordered List",icon:{glyph:"glyphicon glyphicon-list",fa:"fa fa-list","fa-3":"icon-list-ul"},callback:function(e){var t,n,r=e.getSelection();e.getContent();if(0===r.length)t=e.__localize("list text here"),e.replaceSelection("- "+t),n=r.start+2;else if(r.text.indexOf("\n")<0)t=r.text,e.replaceSelection("- "+t),n=r.start+2;else{var i=[];t=(i=r.text.split("\n"))[0],k.each(i,function(e,t){i[e]="- "+t}),e.replaceSelection("\n\n"+i.join("\n")),n=r.start+4}e.setSelection(n,n+t.length)}},{name:"cmdListO",hotkey:"Ctrl+O",title:"Ordered List",icon:{glyph:"glyphicon glyphicon-th-list",fa:"fa fa-list-ol","fa-3":"icon-list-ol"},callback:function(e){var t,n,r=e.getSelection();e.getContent();if(0===r.length)t=e.__localize("list text here"),e.replaceSelection("1. "+t),n=r.start+3;else if(r.text.indexOf("\n")<0)t=r.text,e.replaceSelection("1. "+t),n=r.start+3;else{var i=[];t=(i=r.text.split("\n"))[0],k.each(i,function(e,t){i[e]="1. "+t}),e.replaceSelection("\n\n"+i.join("\n")),n=r.start+5}e.setSelection(n,n+t.length)}},{name:"cmdCode",hotkey:"Ctrl+K",title:"Code",icon:{glyph:"glyphicon glyphicon-asterisk",fa:"fa fa-code","fa-3":"icon-code"},callback:function(e){var t,n,r=e.getSelection(),i=e.getContent();t=0===r.length?e.__localize("code text here"):r.text,n="```\n"===i.substr(r.start-4,4)&&"\n```"===i.substr(r.end,4)?(e.setSelection(r.start-4,r.end+4),e.replaceSelection(t),r.start-4):"`"===i.substr(r.start-1,1)&&"`"===i.substr(r.end,1)?(e.setSelection(r.start-1,r.end+1),e.replaceSelection(t),r.start-1):-1<i.indexOf("\n")?(e.replaceSelection("```\n"+t+"\n```"),r.start+4):(e.replaceSelection("`"+t+"`"),r.start+1),e.setSelection(n,n+t.length)}},{name:"cmdQuote",hotkey:"Ctrl+Q",title:"Quote",icon:{glyph:"glyphicon glyphicon-comment",fa:"fa fa-quote-left","fa-3":"icon-quote-left"},callback:function(e){var t,n,r=e.getSelection();e.getContent();if(0===r.length)t=e.__localize("quote here"),e.replaceSelection("> "+t),n=r.start+2;else if(r.text.indexOf("\n")<0)t=r.text,e.replaceSelection("> "+t),n=r.start+2;else{var i=[];t=(i=r.text.split("\n"))[0],k.each(i,function(e,t){i[e]="> "+t}),e.replaceSelection("\n\n"+i.join("\n")),n=r.start+4}e.setSelection(n,n+t.length)}}]},{name:"groupUtil",data:[{name:"cmdPreview",toggle:!0,hotkey:"Ctrl+P",title:"Preview",btnText:"Preview",btnClass:"btn btn-primary btn-sm",icon:{glyph:"glyphicon glyphicon-search",fa:"fa fa-search","fa-3":"icon-search"},callback:function(e){!1===e.$isPreview?e.showPreview():e.hidePreview()}}]}]],additionalButtons:[],reorderButtonGroups:[],hiddenButtons:[],disabledButtons:[],footer:"",fullscreen:{enable:!0,icons:{fullscreenOn:{fa:"fa fa-expand",glyph:"glyphicon glyphicon-fullscreen","fa-3":"icon-resize-full"},fullscreenOff:{fa:"fa fa-compress",glyph:"glyphicon glyphicon-fullscreen","fa-3":"icon-resize-small"}}},onShow:function(e){},onPreview:function(e){},onSave:function(e){},onBlur:function(e){},onFocus:function(e){},onChange:function(e){},onFullscreen:function(e){},onSelect:function(e){}},k.fn.markdown.Constructor=i,k.fn.markdown.noConflict=function(){return k.fn.markdown=e,this};var t=function(e){var t=e;t.data("markdown")?t.data("markdown").showEditor():t.markdown()};k(document).on("click.markdown.data-api",'[data-provide="markdown-editable"]',function(e){t(k(this)),e.preventDefault()}).on("click focusin",function(e){var r;r=k(document.activeElement),k(document).find(".md-editor").each(function(){var e=k(this),t=r.closest(".md-editor")[0]===this,n=e.find("textarea").data("markdown")||e.find('div[data-provider="markdown-preview"]').data("markdown");n&&!t&&n.blur()})}).ready(function(){k('textarea[data-provide="markdown"]').each(function(){t(k(this))})})});